{"version":3,"sources":["../../src/utils/api_calls.js"],"names":["require","config","API_KEY","process","env","APIKEY","get_id","player_string","axios","get","headers","id","data","Response","get_profile","mem_type","String","profile","get_clan","mem_id","info","res1","results","group","name","about","groupId","clan_id","res2","grab_members","new_info","info_store","members","i","length","push","memType","memberType","destinyUserInfo","displayName","online","isOnline","lastOnline","lastOnlineStatusChange","manifest_call","hash","type","types","response","displayProperties","icon","character_info","char_id","character","light","classHash","module","exports"],"mappings":"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","sourcesContent":["// Imports\nimport axios from \"axios\";\nrequire(\"dotenv\").config(); //Initilize ENV \n\nlet API_KEY = process.env.APIKEY; // Get API key\n\n/**\n * Function to make an API call and return player's IDs\n * @param {string} player_string - username of the player to search for\n * @returns {object} Object containing useful information such as \"DisplayName\", \"MemberType\", \"MembershipID\"\n */\nconst get_id = async (player_string) => {\n    let id = await axios\n        .get(\n            `https://www.bungie.net/Platform/Destiny2/SearchDestinyPlayer` +\n                `/-1/${player_string}`,\n            { headers: { \"X-API-KEY\": API_KEY } }\n        )\n    return id.data.Response\n};\n\n/**\n * Function to make and API call and return profile\n * @param {string} mem_type - bungie Membership Type (provided by get_id())\n * @param {string} id - bungie Membership Id (provided by get_id())\n * @returns {object} Contains data from api call including last online and raw character data\n */\nasync function get_profile(mem_type, id) {\n    const profile = await axios\n        .get(\n            `https://www.bungie.net/Platform/Destiny2/${String(\n                mem_type\n            )}/Profile/` + `${String(id)}/?components=100,205`,\n            { headers: { \"X-API-KEY\": API_KEY } }\n        )\n    return profile.data.Response\n};\n\n/**\n * Makes an API call for the clan of a member\n * @param {string} mem_id - Bungie membership Id (provided by get_id()) \n * @returns {object} - Object containing the members of a clan as well as clan name and desctiption.\n */\nconst get_clan = async (mem_id) => {\n    let info = {};\n    let res1 = await axios.get(\n        `https://www.bungie.net/Platform/GroupV2/User/1/${mem_id}/0/1/`,\n        {\n            headers: { \"X-API-KEY\": API_KEY },\n        }\n    );\n    info[\"name\"] = res1.data.Response.results[0].group.name;\n    info[\"desc\"] = res1.data.Response.results[0].group.about;\n    info[\"clan_id\"] = res1.data.Response.results[0].group.groupId;\n    let res2 = await axios.get(\n        `https://www.bungie.net/Platform//GroupV2/${info.clan_id}/Members/`,\n        {\n            headers: { \"X-API-KEY\": API_KEY },\n        }\n    );\n    let new_info = await grab_members(res2.data.Response.results, info);\n    return new_info\n};\n/**\n * Cleans the data from a clan call\n * @param {Array} data - Array of users from clan call\n * @param {Object} info_store - the Object to store the member information\n * @returns {object} returns the data array with members modified to include membertype, name, online, and lastOnline\n */\nconst grab_members = async (data, info_store) => {\n    info_store.members = [];\n    for (let i = 0; i < data.length; i++) {\n        info_store.members.push({\n            memType: data[i].memberType,\n            name: data[i].destinyUserInfo.displayName,\n            online: data[i].isOnline,\n            lastOnline: data[i].lastOnlineStatusChange,\n        });\n    }\n    return info_store;\n};\n\n/**\n * Makes API call to bungie Manifest\n * @param {string} hash - Hash to query the Manifest for \n * @param {string} type - Type of to search the Manifest for Class or Equipment\n * @returns {object} Object containing the name and icon of the item matching the hash\n */\nconst manifest_call = async (hash, type) => {\n    let types = {\n        \"class\":\"DestinyClassDefinition\",\n        \"equipment\":\"DestinyInventoryItemDefinition\"\n    }\n    let response = await axios.get(`https://www.bungie.net/Platform/Destiny2/Manifest/${types[type]}/${hash+\"\"}/`,{ headers: { \"X-API-KEY\": API_KEY } })\n    return {\n        \"name\":response.data.Response.displayProperties.name,\n        \"icon\":response.data.Response.displayProperties.icon,\n        }\n\n}\n\n/**\n * Makes and API call to get the light and class of a character\n * @param {string} char_id - The id of the character to query for\n * @param {string} mem_type - The membership type of the player to query for\n * @param {string} mem_id - The membership id of the player to query for\n * @returns {object} Object containing the character data class and light\n */\nconst character_info = async (char_id, mem_type, mem_id) => {\n    let character = {}\n    let response = await axios.get(`https://www.bungie.net/Platform/Destiny2/${mem_type}/Profile/${mem_id}/Character/${char_id}/?components=200`,{ headers: { \"X-API-KEY\": API_KEY } })\n    character[\"light\"]=response.data.Response.character.data.light\n    let type = await manifest_call(response.data.Response.character.data.classHash,\"class\")\n    character[\"class\"] = type.name\n    return character\n}\n\nmodule.exports = { get_id, get_profile, get_clan, manifest_call, character_info };\n"],"file":"api_calls.js"}